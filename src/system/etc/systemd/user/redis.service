[Install]
WantedBy=default.target

[Service]
EnvironmentFile=%h/.env
Environment="IMAGE=timonier/redis:latest"
Environment="NAME=redis-%u"
Restart=always
TimeoutStartSec=0

ExecStart=/usr/local/sbin/docker \
    run \
    --name "${NAME}" \
    "${IMAGE}" \
    redis-server

ExecStop=/usr/local/sbin/docker \
    stop \
    "${NAME}"

ExecStopPost=/usr/local/sbin/docker \
    rm \
    --force \
    --volumes \
    "${NAME}"
