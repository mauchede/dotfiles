#!/bin/sh

USER=$(/usr/bin/id -nu)
HOME=$(/usr/bin/getent passwd $USER | cut -d: -f6)

docker run \
    -i \
    -t=$([ -t 0 ] && echo "true" || echo "false") \
    -u "$USER" \
    -v /etc/group:/etc/group:ro \
    -v /etc/passwd:/etc/passwd:ro \
    -v /etc/localtime:/etc/localtime:ro \
    -v "$HOME:$HOME" \
    -v "$PWD:$PWD" \
    -w "$PWD" \
    --net=host \
    --rm \
    ${IMAGE:-node}:${TAG:-5.9} /bin/bash -c "echo > /dev/null && /usr/local/bin/npm $*"
